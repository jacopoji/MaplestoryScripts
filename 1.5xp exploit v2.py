import os
import sys
import time
import GameState
import Inventory
import Character
import Terminal
import Field

if not any("SunCat" in s for s in sys.path):
    sys.path.append(os.getcwd() + "\SunCat")

try:
    import SunCat
    import SCHotkey
    import SCLib
except BaseException:
    print("Couldn't find SunCat module", flush=True)

# WTFM x Colorless

# Constants
buffmap_id = 701100015
xpbonus = 2023532
mesobonus = 2023533
attbonus = 2023534
hs = 2311003
htr = 5040004
map = Field.GetID()

# Variables To Change
# Change these values accordingly
using_mule = False
mule_channel = 5

def ToggleRushByLevel(indicator):
    Terminal.SetCheckBox("Rush By Level",indicator)
    Terminal.SetRushByLevel(indicator)

if GameState.IsInGame():
    if Inventory.FindItemByID(htr).valid:
        # Checks for HS
        if using_mule:
            Terminal.ChangeChannel(mule_channel)
            if not Character.HasBuff(2, hs):
                time.sleep(3)

        # Checks for Fortune Buff
        if not Character.HasBuff(1, xpbonus):
            ToggleRushByLevel(False)
            if map is not buffmap_id:
                Terminal.Rush(buffmap_id)
        else:
            ToggleRushByLevel(True)
            time.sleep(1)
    else:
        Terminal.ChangeStatus("Missing HTR")
