import Packet, time, Field, GameState, Character, Terminal

ReactorRecv = 0x051F
ReactorSend = 0x042E
MovementSend = 0x00D5
delay = 0.01

def grabObjectID():
   iPacket = Packet.WaitForRecv(ReactorRecv, 10000)
   if iPacket.GetRemaining() > 0:
       objectID = iPacket.ReadLong(4)
       Terminal.SetProperty(str(GameState.GetChannel()), objectID)
    
def blubBlub():
   oPacket = Packet.COutPacket(ReactorSend)
   oPacket.Encode4(Terminal.GetProperty(str(GameState.GetChannel()), 0))
   oPacket.Encode4(2)
   oPacket.Encode2(0x106)
   oPacket.Encode4(0)
   Packet.SendPacket(oPacket)

while GameState.IsInGame():
   if Field.GetID() == 230040420:
       if Terminal.GetProperty(str(GameState.GetChannel()), 0) == 0:
           Terminal.SetCheckBox("Jump Down Anywhere", True)
           if Character.GetPos().y <= 78:
               Character.JumpDown()
               time.sleep(2)
           Character.JumpDown()
           grabObjectID()
       else:
           blubBlub()
           time.sleep(delay)
           Character.AMoveX(-491)